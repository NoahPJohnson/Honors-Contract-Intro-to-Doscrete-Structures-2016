/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package BplusTree;

/**
 *
 * @author Noah
 */

import java.util.ArrayList;
import java.util.Collections;

public class Node
{
 private int n = 3;
 private int element;
 private ArrayList<Integer> keyList;
 private ArrayList<Node> children;
 private Node sibling;
 private Node parent;
 
 private int childCount = 0;
 private boolean root = false;

 public Node(boolean r)
 {
  keyList = new ArrayList();
  children = new ArrayList();
  root = r;
  if (root == false)
     {
         
     } 
 }        
 
 public int getN()
 {
    return n;
 } 
 
 public boolean checkIfRoot()
 {
    return root;
 }     
 
 public ArrayList getKeyList()
 {
    return keyList;   
 }
 
 public int getKey(int i)
 {
    return keyList.get(i);
 }        
 
 public ArrayList<Node> getChildren()
 {
    return children;   
 }        
 
 public int getChildCount()
 {
     return childCount;
 }  
 
 public Node getChild(int i)
 {
     return children.get(i);
 }        
         
 public void setKey(int e)
 {
    keyList.add(e);
    Collections.sort(keyList);
    if (keyList.size() >= n)
       {
        split();   
       } 
 }   
 
 public void addChild()
 {
    childCount ++;
    children.add(new Node(false));
 }          
 
 public void addSibling()
 {
     
 }  
 
 public void addSpecificChild(Node c)
 {
     childCount ++;
     children.add(c);
 }        
 
 public void addRootParent()
 {
     
 }   
 
 public boolean itemSearch(int key)
 {
    if (keyList.contains(key))
       {
        return true;
       }
    else
       {
        return false; 
       } 
 }       
         
 public void split()
 {
     int mid = n/2;
     int midKey = keyList.get((n/2));
     int index = 0;
     if (checkIfRoot() == true)
        {
         addChild();
         for (int i = 0; i < mid; i ++)
             {
              children.get(childCount-1).setKey(keyList.get(i));
             }
         addChild();
         children.get(childCount-2).addSpecificChild(children.get(childCount-1));
         for (int i = mid; i < n; i ++)
             {
              children.get(childCount-1).setKey(keyList.get(i));
             }
         while (keyList.size() != 1)
             {
              if (keyList.get(index) != midKey)
                 {
                  System.out.println("removed");
                  keyList.remove(index);
                 }
              index ++;
             }
        } 
     else
        {
         addSibling();
         for (int i = mid; i < keyList.size(); i ++)
             {
              children.get(childCount-1).setKey(keyList.get(i));
             }
         for (int i = mid; i < keyList.size(); i ++)
             {
              keyList.remove(i);
             }
         
        } 
 }
 
 public String toString()
 {
     String result = "";
     for (int i = 0; i < keyList.size(); i ++)
         {
          result += keyList.get(i);
          result += ",";
         }
     return result;
 }        
}


